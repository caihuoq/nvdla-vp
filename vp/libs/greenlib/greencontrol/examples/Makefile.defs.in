# Configuration of dependencies

DEPENDENCIES = GREENSOCS SYSTEMC TLM BOOST

GREENSOCS_CPPFLAGS = -D_REENTRANT
GREENSOCS_INCLUDEDIR = @GreenSocs_INCLUDE_DIRS@
GREENSOCS_LIBRARYDIR = @GreenSocs_LIBRARY_DIRS@
GREENSOCS_LIBRARIES = @GreenSocs_LIBRARIES@

SYSTEMC_CPPFLAGS = -DUSE_STATIC_CASTS -DSC_INCLUDE_DYNAMIC_PROCESSES
SYSTEMC_INCLUDEDIR = @SystemC_INCLUDE_DIRS@
SYSTEMC_LIBRARYDIR = @SystemC_LIBRARY_DIRS@
SYSTEMC_LIBRARIES = @SystemC_LIBRARIES@

TLM_INCLUDEDIR = @TLM_INCLUDE_DIRS@
TLM_LIBRARYDIR = 
TLM_LIBRARIES = 

BOOST_INCLUDEDIR = @Boost_INCLUDE_DIRS@
BOOST_LIBRARYDIR = @Boost_LIBRARY_DIRS@
BOOST_LIBRARIES = @Boost_LIBRARIES@


################################
# GENERIC BELLOW HERE

# SYSTEMC_CPPFLAGS += $(addprefix -I,${SYSTEMC_INCLUDEDIR})
# SYSTEMC_LDFLAGS = $(addprefix -L,${SYSTEMC_LIBRARYDIR})
# SYSTEMC_LDLIBS = $(addprefix -l,${SYSTEMC_LIBRARIES})

define BUILD_COMPILER_FLAGS
   $(1)_CPPFLAGS += $$(addprefix -I,$${$(1)_INCLUDEDIR})
#   $$(warning $(1)_CPPFLAGS = $$($(1)_CPPFLAGS))
   $(1)_LDFLAGS += $$(addprefix -L,$${$(1)_LIBRARYDIR})
#   $$(warning $(1)_LDFLAGS = $$($(1)_LDFLAGS))
   $(1)_LDLIBS += $$(addprefix -l,$${$(1)_LIBRARIES})
#   $$(warning $(1)_LDLIBS = $$($(1)_LDLIBS))
endef

$(foreach dep,$(DEPENDENCIES),$(eval $(call BUILD_COMPILER_FLAGS,$(dep))))


################################
# Core of the Makefile

CPPFLAGS += $(foreach dep,$(DEPENDENCIES),${${dep}_CPPFLAGS})
LDFLAGS += $(foreach dep,$(DEPENDENCIES),${${dep}_LDFLAGS})
LDLIBS += $(foreach dep,$(DEPENDENCIES),${${dep}_LDLIBS})

${MODULE}: $(OBJS)

clean:
	rm -f $(OBJS) ${MODULE}
